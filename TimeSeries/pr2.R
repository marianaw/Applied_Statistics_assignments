library(TSA)


# ---------------------------------------------------------------------------------------
# --------------------------------------- EJ 2 ------------------------------------------
# ---------------------------------------------------------------------------------------
# Autocorrelación teórica:
tita = 0.5
rho = tita/(1+tita**2)
n = 1000

# Varianza del estimador de rho:
var_rho = 1 - 3*rho^2 + 4*rho^4

# Varianza de la distribución normal para n grande:
normal_var = var_rho/n; normal_var

corrs = c()
vars = c()
for(i in c(1:10000)){
  ma1 = arima.sim(model=list(ma=c(tita)),n=n)
  vars = c(vars, var(ma1))
  corrs = c(corrs, acf(ma1, lag.max = 1)$acf[1])
}

qqnorm(corrs)
var(corrs)
mean(corrs)



# ---------------------------------------------------------------------------------------
# --------------------------------------- EJ 3 ------------------------------------------
# ---------------------------------------------------------------------------------------

ts1 = c(1.58140989,1.67272129,-0.20673310,-0.25763881,0.91444169,0.23645288,
        -0.62037195,1.25516417,-0.37188693,1.35456317,-0.79319867,-0.81433962,
        0.76354534,0.42590856,-0.70023016,-0.22369423,-0.68306757,1.01807714,
        0.33340446,0.25542296,-0.43328491,-0.29408937,1.70612017,0.83789994,
        -0.55133025,-0.34410788,0.90716306,-1.23000268,-0.15784355,1.30717454,
        -0.87045505,-1.64078256,0.16689703,0.81987600,-2.12849455,0.85279688,
        -0.32389863,0.38821971,-2.00130821,-1.08607262,0.43964057,-0.84383588,
        -0.84442046,0.61733990,1.39402513,-0.88385873,0.16763894,-1.30799568,
        -0.32557222,-0.41823417,-0.35672860,-0.99445964,1.39434178,1.24859399,
        -0.67904271,1.12610066,0.05126790,-1.25090346,-0.45454506,0.09545263,
        0.12732253,1.27354752,0.02189058,-0.25324174,0.66795048,1.10945509,
        -0.38381247,-0.62412611,0.12026791,0.79145430,2.01561915,-0.12784485,
        -0.92000404,-0.20334063,2.45604721,1.62533359,0.40994200,-0.31359899,
        0.09685527,-0.39410792,1.10874868,-1.30129041,0.34088745,-1.07243801,
        -0.85133468,-0.83994085,1.74142973,1.00889960,-0.52960444,1.09281412,
        0.75519905,0.20013132,-1.38246025,-0.48438306,-0.76331774,2.50265959,
        -1.10137601,-0.02400208,0.53341817,-0.58177217)
ts2 = c(3.7509931,2.8143443,1.7436520,3.5325694,
        3.0432822,2.2728383,2.0912939,4.1375667,
        4.3421878,2.8983095,2.7050325,4.8482395,
        3.1540935,4.3433892,2.6784705,3.8282947,
        4.8498414,4.2786009,4.9031624,4.2941249,
        3.9638419,3.3479041,5.2413506,3.9885544,
        4.0522257,2.8664467,4.5236282,3.1078880,
        3.2338002,3.9404804,4.2964595,3.0093710,
        2.8312054,3.9856682,2.6770787,2.8398065,
        2.5608051,2.5042206,1.8708005,2.0711617,
        0.1514882,2.9122517,2.9941203,2.0359619,
        4.9834890,5.6832878,6.4594108,3.7031152,
        3.0339483,3.3930568,4.3211884,3.7503829,
        5.1519783,4.2371894,4.5242690,3.4539646,
        3.3064563,5.0544619,5.4660589,5.3691690,
        3.0369561,2.7246812,0.8354637,2.6971702,
        2.8670155,3.1217189,1.9743663,2.6315586,
        -0.1131842,0.2089867,0.6900336,1.2277510,
        1.4648531,0.4862778,2.0607106,1.9871701,
        2.5762774,2.8561926,2.2494794,1.9066318,
        1.5977131,4.3644991,2.7410913,3.1352019,
        3.8641521,4.9890663,3.1494581,3.7092688,
        4.8791422,4.2774556,3.5423781,2.4634287,
        2.9358995,4.6032572,3.0497022,3.6637976,
        2.6978679,3.1843756,1.9057657,1.5343016)

ts3 = c(9.292052,9.889104,9.118911,9.337892,9.782416,
        10.057694,10.099885,9.281896,9.630748,10.633053,
        10.966514,11.334780,11.325072,11.201938,9.741618,
        10.145811,10.867666,10.350876,9.762967,11.088836,
        10.488869,10.520406,10.474293,10.184891,10.525910,
        8.681788,9.051721,10.881019,9.475752,10.870621,
        9.635084,9.655665,9.166666,8.354494,8.458285,
        9.304100,10.060254,9.736895,9.058148,11.564933,
        6.767717,9.189433,8.437541,10.286899,11.982544,
        11.690506,8.031017,10.134973,9.859358,7.817547,
        10.285517,10.626560,9.173162,9.291674,12.313421,
        9.731558,8.956362,9.606184,9.143600,9.667057)

ts1 = ts(ts1)
acf(ts1)
pacf(ts1)
plot.ts(ts1)

ts2 = ts(ts2)
acf(ts2)
pacf(ts2)
plot.ts(ts2)

ts3 = ts(ts3)
acf(ts3)
pacf(ts3)
plot.ts(ts3)
